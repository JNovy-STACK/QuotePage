<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STACK Cybersecurity Quote</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: 20px auto;
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            padding: 30px;
        }
        .header-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 20px;
            border-bottom: 1px solid #e0e0e0;
            margin-bottom: 30px;
        }
        .header-section img {
            max-height: 160px; /* Increased image size to double */
            width: auto; /* Ensure image scales proportionally */
        }
        .header-section div {
            text-align: right;
            font-size: 0.9rem;
            color: #555;
        }
        .section-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: #ffffff; /* Changed text color to white for contrast */
            background-color: #0062ff; /* Changed to dark blue #0062ff */
            padding: 10px 15px; /* Added padding to make it a bar */
            margin-bottom: 20px;
            border-radius: 8px; /* Slightly rounded corners for the bar */
            display: inline-block; /* Ensures background only covers text width */
            width: 100%; /* Make it span full width */
            box-sizing: border-box; /* Include padding in width */
        }
        .input-group {
            margin-bottom: 15px;
        }
        .input-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 5px;
            color: #333;
        }
        .input-group input[type="number"],
        .input-group input[type="text"],
        .input-group input[type="date"], /* Added date type */
        .input-group textarea,
        .input-group select { /* Added select to input-group styling */
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 8px;
            font-size: 1rem;
            box-sizing: border-box;
            transition: border-color 0.3s ease;
        }
        .input-group input[type="number"]:focus,
        .input-group input[type="text"]:focus,
        .input-group input[type="date"]:focus, /* Added date type */
        .input-group textarea:focus,
        .input-group select:focus { /* Added select to focus styling */
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 25px;
            background-color: #fdfdfd;
            border-radius: 8px;
            overflow: hidden; /* Ensures rounded corners apply to content */
        }
        table th, table td {
            border: 1px solid #e0e0e0;
            padding: 12px 15px;
            text-align: left;
        }
        table th {
            background-color: #eff6ff; /* Tailwind bg-blue-50 */
            color: #2563eb; /* Tailwind text-blue-700 */
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.85rem;
        }
        table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        table tr:hover {
            background-color: #f0f8ff; /* Light blue hover */
        }
        .total-row td {
            font-weight: 700;
            background-color: #e0f2fe; /* Tailwind bg-blue-100 */
            color: #1e40af; /* Tailwind text-blue-800 */
            font-size: 1.1rem;
        }
        .grand-total-section {
            background-color: #dbeafe; /* Tailwind bg-blue-200 */
            padding: 20px;
            border-radius: 12px;
            margin-top: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .grand-total-section div {
            display: flex;
            justify-content: space-between;
            font-size: 1.3rem;
            font-weight: 700;
            color: #1e40af;
            margin-bottom: 10px;
        }
        .grand-total-section div:last-child {
            margin-bottom: 0;
            padding-top: 10px;
            border-top: 1px solid #93c5fd; /* Tailwind border-blue-300 */
        }

        .button-group {
            text-align: center;
            margin-top: 30px;
        }
        .button-group button {
            background-color: #3498db;
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            margin: 0 5px; /* Added margin for buttons */
        }
        .button-group button:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }
        .notes-section {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #e0e0e0;
            color: #666;
            font-size: 0.9rem;
        }
        .acceptance-section {
            margin-top: 40px;
            padding-top: 30px;
            border-top: 2px dashed #ccc;
        }
        .acceptance-section p {
            margin-bottom: 20px;
            font-size: 1rem;
            color: #333;
        }
        .signature-line {
            border-bottom: 1px solid #888;
            padding-bottom: 5px;
            margin-top: 50px;
            width: 70%;
            font-size: 0.9rem;
            color: #555;
        }
        .delete-row-btn {
            background-color: #ef4444; /* Red color for delete */
            color: white;
            padding: 4px 8px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            margin-left: 10px;
            transition: background-color 0.3s ease;
        }
        .delete-row-btn:hover {
            background-color: #dc2626;
        }
        /* Print specific styles */
        @media print {
                 /* Reset body margins and background for print */
    body {
        margin: 0;
        padding: 0;
        background-color: white;
    }
    
    /* Container adjustments - reduced padding for more content space */
    .container {
        max-width: 100%;
        margin: 0;
        padding: 15px;
        box-shadow: none;
        border-radius: 0;
    }
    
    /* Reduce header section sizing */
    .header-section {
        padding-bottom: 15px;
        margin-bottom: 20px;
    }
    
    .header-section img {
        max-height: 80px; /* Reduced from 160px */
        width: auto;
    }
    
    .header-section div {
        font-size: 0.75rem; /* Reduced from 0.9rem */
    }
    
    /* Main title sizing */
    h1 {
        font-size: 1.5rem !important; /* Reduced from 2.5rem (text-4xl) */
        margin-bottom: 15px !important;
    }
    
    /* Section titles - significantly reduced */
    .section-title {
        font-size: 1.1rem !important; /* Reduced from 1.8rem */
        padding: 8px 12px !important; /* Reduced padding */
        margin-bottom: 15px !important;
    }
    
    /* Hide elements that shouldn't print */
    .button-group,
    .add-row-btn,
    .delete-row-btn,
    .print-footer {  /* Hide footer completely */
        display: none !important;
    }
    
    /* Ensure inputs and textareas print their values */
    input[type="text"],
    input[type="number"],
    input[type="date"],
    textarea,
    select {
        border: none !important;
        background-color: transparent !important;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
        font-size: 0.85rem; /* Slightly smaller for print */
    }
    
    /* Label font size */
    .input-group label {
        font-size: 0.8rem;
        font-weight: 500;
    }
    
    /* Make sure input values are visible */
    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
    }
    
    /* Page break controls */
    .page-break {
        page-break-before: always;
        break-before: always;
    }
    
    /* Avoid breaks inside critical elements */
    table,
    .grand-total-section,
    .acceptance-section {
        page-break-inside: avoid;
        break-inside: avoid;
    }
    
    /* Header handling for first page */
    .first-page-only {
        display: block;
    }
    
    /* Hide repeated headers by default */
    .repeated-print-header {
        display: none;
    }
    
    /* Show repeated headers after page breaks */
    .page-break + .repeated-print-header {
        display: block;
        page-break-inside: avoid;
    }
    
    /* Ensure content after headers doesn't break */
    .content-after-header {
        page-break-inside: avoid;
    }
    
    /* Table styling for print */
    table {
        width: 100%;
        font-size: 0.75rem; /* Reduced from 0.9rem */
    }
    
    table th,
    table td {
        padding: 6px 8px; /* Reduced padding */
        font-size: 0.75rem;
    }
    
    /* Table headers */
    table th {
        font-size: 0.7rem !important; /* Smaller headers */
        text-transform: uppercase;
    }
    
    /* Plans table header adjustments */
    table tr th[colspan="4"] {
        font-size: 1.2rem !important; /* Reduced from 1.8rem */
        padding: 10px !important;
    }
    
    table tr th[style*="font-size: large"] {
        font-size: 0.85rem !important; /* Override inline large font */
    }
    
    /* Total rows */
    .total-row td {
        font-size: 0.85rem !important; /* Reduced from 1.1rem */
        font-weight: 600;
    }
    
    /* Grand total section */
    .grand-total-section {
        padding: 15px;
        margin-top: 20px;
        margin-bottom: 20px;
    }
    
    .grand-total-section div {
        font-size: 0.95rem !important; /* Reduced from 1.3rem */
        margin-bottom: 8px;
    }
    
    /* Ensure colored elements print correctly */
    .section-title,
    .total-row td,
    .grand-total-section,
    table th {
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
    }
    
    /* Blue bar at top of pages */
    .blue-bar-top-print,
    .repeated-print-header > div:first-child {
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
        height: 30px !important; /* Reduced from 40px */
        background-color: #0062ff !important;
    }
    
    /* Ensure checkmarks and crosses print correctly */
    td[style*="color: green"],
    td[style*="color: red"] {
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
        font-weight: bold;
        font-size: 0.9rem; /* Reduced from 1.1rem */
    }
    
    /* Signature lines */
    .signature-line {
        border-bottom: 1px solid #000;
        min-height: 25px;
        margin-bottom: 8px;
        font-size: 0.75rem;
    }
    
    /* Ensure links print in black */
    a {
        color: #000 !important;
        text-decoration: none !important;
        font-size: 0.8rem;
    }
    
    /* Make readonly inputs look normal */
    input[readonly],
    .bg-gray-100 {
        background-color: transparent !important;
    }
    
    /* Hide any hover effects */
    table tr:hover {
        background-color: transparent !important;
    }
    
    /* Needs Assessment textarea styling */
    #needsAssessmentText {
        min-height: 200px; /* Reduced from 300px */
        resize: none;
        font-family: inherit;
        line-height: 1.4;
        font-size: 0.85rem;
    }
    
    /* About section text */
    .section p {
        font-size: 0.85rem;
        line-height: 1.4;
    }
    
    /* Acceptance section */
    .acceptance-section p {
        font-size: 0.85rem;
        margin-bottom: 15px;
    }
    
    /* Hide empty table cells in print */
    td:empty {
        border: none !important;
    }
    
    /* Page margins - adjusted for better right margin */
    @page {
        margin: 0.5in 0.5in 0.5in 0.75in; /* top, right, bottom, left */
        size: letter portrait;
    }
    
    /* First page special handling */
    @page:first {
        margin-top: 0.5in;
    }
            }

    
    </style>
</head>
<body>
    <div class="container">
        <!-- Blue bar above the main header - now with a specific class for print styling -->
        <div class="w-full h-12 mb-6 blue-bar-top-print" style="background-color: #0062ff;"></div>

        <!-- Header Section (only one instance) - now with a specific class for print styling -->
        <header class= "first-page-only print:block">
            <div class="header-section header-section-print">
                <img src="https://www.stackcybersecurity.com/img/logos/stack-cybersecurity-og.jpg" alt="Company Logo">
                <div>
                    <p>33131 Schoolcraft Road</p>
                    <p>Livonia, MI 48150</p>
                    <p>734-744-5300</p>
                    <p><a href="https://stackcyber.com" class="text-blue-600 hover:underline">https://stackcyber.com</a></p>
                </div>
            </div>
        </header>    

        <!-- Content after header - now with a specific class for print styling -->
        <div class="content-after-header content-after-header-print">
            <h1 class="text-4xl font-bold text-gray-800 mb-6">Cybersecurity Managed Service Proposal</h1>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                <div class="input-group">
                    <label for="clientName">Client Name:</label>
                    <input type="text" id="clientName" class="rounded-lg">
                </div>
                <div class="input-group">
                    <label for="agreementMonths">Agreement Months:</label>
                    <input type="number" id="agreementMonths" value="60" min="1" class="rounded-lg">
                </div>
                <div class="input-group">
                    <label for="proposalDate">Proposal Date:</label>
                    <input type="date" id="proposalDate" value="2025-07-21" class="rounded-lg">
                </div>
            </div>

            <!-- About STACK Cybersecurity Section -->
            <div class="section mb-8">
                <h2 class="section-title">ABOUT STACK CYBERSECURITY</h2>
                <p class="text-gray-700 leading-relaxed">
                    At STACK Cybersecurity, we specialize in proactive monitoring and threat detection to identify and
                    neutralize security risks before they escalate. Our team strengthens your defenses against ransomware,
                    business email compromise (BEC), and a wide range of cyber threats. Beyond cybersecurity, we provide
                    full-spectrum IT infrastructure managementâ€”covering everything from printers, desktops, and laptops
                    to servers, patch management, and cloud hosting. With a commitment to exceptional service and
                    support, STACK delivers not just peace of mind but added value through cutting-edge cybersecurity
                    solutions tailored to your business needs.
                </p>
            </div>

            <!--Plan Table-->
            <table>
                <tr>
                    <th style="border: none; background: none; pointer-events: none;"></th>
                    <th colspan="4" style="text-align: center; pointer-events: none; font-size: xx-large; font-weight: 700;"> Plans </th>
                </tr>
  <tr>
    <th style="text-align: center; text-transform: none; font-size: large;">Service</th>
    <th style="text-align: center; text-transform: none; font-size: large;">Security Basics</th>
    <th style="text-align: center; text-transform: none; font-size: large;">Security Standards</th>
    <th style="text-align: center; text-transform: none; font-size: large;">CoreSTACK</th>
    <th style="text-align: center; text-transform: none; font-size: large;">CyberSTACK</th>
  </tr>
  <tr>
    <td>Server and Workstation Monitoring</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
  </tr>
    <tr>
    <td>System Administration and Maintenance</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
  </tr>
    <tr>
    <td>Windows Patching</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
  </tr>
    <tr>
    <td>End Point Detection & Response</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
  </tr>
    <tr>
    <td>Managed Extended Detection & Response</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
  </tr>
    <tr>
    <td>Security Information & Event Management (SIEM) (7 Day)</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
  </tr>
    <tr>
    <td>Critical Vulnerability & Exceptions (CVE) Scanning</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
  </tr>
    <tr>
    <td>Automated CVE Patching</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
  </tr>
    <tr>
    <td>Privilege Access Management (PAM)</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
  </tr>
    <tr>
    <td>Unlimited Support</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
  </tr>
    <tr>
    <td>Vendor Support</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
  </tr>
    <tr>
    <td>Existing Firewall Management</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
  </tr>
    <tr>
    <td>Secure Access Service Edge (SASE)</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
  </tr>
    <tr>
    <td>SIEM (30 Day)</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
  </tr>
    <tr>
    <td>Security & Awareness Training Platform</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
  </tr>
    <tr>
    <td>Dark Web Monitoring</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
  </tr>
    <tr>
    <td>Simulated Phishing</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
  </tr>
    <tr>
    <td>Email Backup</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
  </tr>
    <tr>
    <td>Email Advanced Attack Protection</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
  </tr>
    <tr>
    <td>Email Monitoring</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
  </tr>
    <tr>
    <td>Malicious File Monitoring</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
  </tr>
    <tr>
    <td>Multifactor Authentication (MFA)</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: green; text-align: center;">&check;</td>
    <td style="color: green; text-align: center;">&check;</td>
  </tr>
    <tr>
    <td>SIEM (90 Day)</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: green; text-align: center;">&check;</td>
  </tr>
    <tr>
    <td>Password Manager</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: green; text-align: center;">&check;</td>
  </tr>
    <tr>
    <td>Microsoft Premium License</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: green; text-align: center;">&check;</td>
  </tr>
    <tr>
    <td>Workstation Backup</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: green; text-align: center;">&check;</td>
  </tr>
    <tr>
    <td>Server Backup</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: green; text-align: center;">&check;</td>
  </tr>
    <tr>
    <td>Mobile Device Management</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: green; text-align: center;">&check;</td>
  </tr>
    <tr>
    <td>Microsoft Intune Workstation Management</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: green; text-align: center;">&check;</td>
  </tr>
    <tr>
    <td>Single Sign On (SSO)</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: green; text-align: center;">&check;</td>
  </tr>
    <tr>
    <td>Password-less Authentication</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: green; text-align: center;">&check;</td>
  </tr>
    <tr>
    <td>Conditional Access Policies</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: green; text-align: center;">&check;</td>
  </tr>
    <tr>
    <td>Annual Tabletop Incident Response Exercise</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: red; text-align: center;">&cross;</td>
    <td style="color: green; text-align: center;">&check;</td>
  </tr>
    <tr>
    <td>CIO/CISO - As Needed</td>
    <td>$20/month</td>
    <td>$20/month</td>
    <td>$20/month</td>
    <td>$20/month</td>
  </tr>
    <tr>
    <td>Quarterly Business Risk Reviews</td>
    <td>$20/month</td>
    <td>$20/month</td>
    <td>$20/month</td>
    <td>$20/month</td>
  </tr>
    <tr>
    <td>Annual Automated Penetration Testing</td>
    <td>$40/month</td>
    <td>$40/month</td>
    <td>$40/month</td>
    <td>$40/month</td>
  </tr>
    <tr>
    <td>Hardware Firewall</td>
    <td>$120/month</td>
    <td>$120/month</td>
    <td>$120/month</td>
    <td>$120/month</td>
  </tr>
    <tr style="font-weight: bolder; font-size: larger; ">
    <td>Flate Rate Pricing</td>
    <td>$85.00</td>
    <td>$200.00</td>
    <td>$300.00</td>
    <td>$365.00</td>
    </tr>
    <th colspan="2" style="border: none; background: none; pointer-events: none;"></th>
    <th colspan="3" style="text-align: center; pointer-events: none; text-transform: none;"> 5 User Minimum </th>


</table>

            <div class="page-break"></div>

            <!-- Repeated Header for NEEDS ASSESSMENT page -->
            <div class="repeated-print-header">
                <div class="w-full h-12" style="background-color: #0062ff;"></div>
                <div class="header-section">
                    <img src="https://www.stackcybersecurity.com/img/logos/stack-cybersecurity-og.jpg" alt="Company Logo">
                    <div>
                        <p>33131 Schoolcraft Road</p>
                        <p>Livonia, MI 48150</p>
                        <p>734-744-5300</p>
                        <p><a href="https://stackcyber.com" class="text-blue-600 hover:underline">https://stackcyber.com</a></p>
                    </div>
                </div>
            </div>
            <div class="content-after-header">
                <h2 class="section-title" contenteditable="true">NEEDS ASSESSMENT</h2>
                <textarea id="needsAssessmentText" class="w-full p-2 border rounded-md" rows="10"> Needs Assessment goes here</textarea>
            </div>

            <div class="page-break"></div>

            <!-- Repeated Header for PROPOSED COST page -->
            <div class="repeated-print-header">
                <div class="w-full h-12" style="background-color: #0062ff;"></div>
                <div class="header-section">
                    <img src="https://www.stackcybersecurity.com/img/logos/stack-cybersecurity-og.jpg" alt="Company Logo">
                    <div>
                        <p>33131 Schoolcraft Road</p>
                        <p>Livonia, MI 48150</p>
                        <p>734-744-5300</p>
                        <p><a href="https://stackcyber.com" class="text-blue-600 hover:underline">https://stackcyber.com</a></p>
                    </div>
                </div>
            </div>
            <div class="content-after-header"> <!-- This content starts on a new page -->
                <h2 class="section-title">PROPOSED COST - MONTHLY RECURRING</h2>
                <p class="text-gray-600 mb-4">Quotation valid for 30 days</p>

                <table class="mb-8 rounded-lg shadow-sm" id="monthlyRecurringTable">
                    <thead>
                        <tr>
                            <th>QUANTITY</th>
                            <th>DESCRIPTION</th>
                            <th>DEVICE/LICENSE</th>
                            <th>PRICE</th>
                            <th>TOTAL</th>
                            <th></th> <!-- For delete button -->
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Existing rows will be dynamically generated or can be left as examples -->
                        <tr>
                            <td><input type="number" class="qty-input w-20 p-1 border rounded-md" value="6" min="0"></td>
                            <td>
                                <select class="service-select w-full p-1 border rounded-md">
                                    <option value="securityBasics">Security Basics</option>
                                    <option value="securityStandardsPlan">Security Standards (Plan)</option>
                                    <option value="coreStack">CoreSTACK</option>
                                    <option value="cyberStack">CyberSTACK</option>
                                    <option value="securityStandardsServer">Security Standards (Per Server)</option>
                                    <option value="cioCiso">CIO/CISO - As Needed</option>
                                    <option value="annualPenTesting">Annual Automated Penetration Testing</option>
                                    <option value="hardwareFirewall">Hardware Firewall</option>
                                    <option value="customAddOn">Custom Add-On / Other</option>
                                </select>
                            </td>
                            <td class="license-display"></td>
                            <td><input type="number" class="price-input w-28 p-1 border rounded-md" step="0.01" value="0.00"></td>
                            <td class="row-total">$0.00</td>
                            <td><button class="delete-row-btn">X</button></td>
                        </tr>
                        <tr>
                            <td><input type="number" class="qty-input w-20 p-1 border rounded-md" value="1" min="0"></td>
                            <td>
                                <select class="service-select w-full p-1 border rounded-md">
                                    <option value="securityBasics">Security Basics</option>
                                    <option value="securityStandardsPlan">Security Standards (Plan)</option>
                                    <option value="coreStack">CoreSTACK</option>
                                    <option value="cyberStack">CyberSTACK</option>
                                    <option value="securityStandardsServer" selected>Security Standards (Per Server)</option>
                                    <option value="cioCiso">CIO/CISO - As Needed</option>
                                    <option value="annualPenTesting">Annual Automated Penetration Testing</option>
                                    <option value="hardwareFirewall">Hardware Firewall</option>
                                    <option value="customAddOn">Custom Add-On / Other</option>
                                </select>
                            </td>
                            <td class="license-display"></td>
                            <td><input type="number" class="price-input w-28 p-1 border rounded-md" step="0.01" value="0.00"></td>
                            <td class="row-total">$0.00</td>
                            <td><button class="delete-row-btn">X</button></td>
                        </tr>
                        <tr>
                            <td><input type="number" class="qty-input w-20 p-1 border rounded-md" value="1" min="0"></td>
                            <td>
                                <select class="service-select w-full p-1 border rounded-md">
                                    <option value="securityBasics">Security Basics</option>
                                    <option value="securityStandardsPlan">Security Standards (Plan)</option>
                                    <option value="coreStack">CoreSTACK</option>
                                    <option value="cyberStack">CyberSTACK</option>
                                    <option value="securityStandardsServer">Security Standards (Per Server)</option>
                                    <option value="cioCiso" selected>CIO/CISO - As Needed</option>
                                    <option value="annualPenTesting">Annual Automated Penetration Testing</option>
                                    <option value="hardwareFirewall">Hardware Firewall</option>
                                    <option value="customAddOn">Custom Add-On / Other</option>
                                </select>
                            </td>
                            <td class="license-display"></td>
                            <td><input type="number" class="price-input w-28 p-1 border rounded-md" step="0.01" value="0.00"></td>
                            <td class="row-total">$0.00</td>
                            <td><button class="delete-row-btn">X</button></td>
                        </tr>
                        <tr>
                            <td><input type="number" class="qty-input w-20 p-1 border rounded-md" value="1" min="0"></td>
                            <td>
                                <select class="service-select w-full p-1 border rounded-md">
                                    <option value="securityBasics">Security Basics</option>
                                    <option value="securityStandardsPlan">Security Standards (Plan)</option>
                                    <option value="coreStack">CoreSTACK</option>
                                    <option value="cyberStack">CyberSTACK</option>
                                    <option value="securityStandardsServer">Security Standards (Per Server)</option>
                                    <option value="cioCiso">CIO/CISO - As Needed</option>
                                    <option value="annualPenTesting" selected>Annual Automated Penetration Testing</option>
                                    <option value="hardwareFirewall">Hardware Firewall</option>
                                    <option value="customAddOn">Custom Add-On / Other</option>
                                </select>
                            </td>
                            <td class="license-display"></td>
                            <td><input type="number" class="price-input w-28 p-1 border rounded-md" step="0.01" value="0.00"></td>
                            <td class="row-total">$0.00</td>
                            <td><button class="delete-row-btn">X</button></td>
                        </tr>
                        <tr>
                            <td><input type="number" class="qty-input w-20 p-1 border rounded-md" value="0" min="0"></td>
                            <td>
                                <select class="service-select w-full p-1 border rounded-md">
                                    <option value="securityBasics">Security Basics</option>
                                    <option value="securityStandardsPlan">Security Standards (Plan)</option>
                                    <option value="coreStack">CoreSTACK</option>
                                    <option value="cyberStack">CyberSTACK</option>
                                    <option value="securityStandardsServer">Security Standards (Per Server)</option>
                                    <option value="cioCiso">CIO/CISO - As Needed</option>
                                    <option value="annualPenTesting">Annual Automated Penetration Testing</option>
                                    <option value="hardwareFirewall" selected>Hardware Firewall</option>
                                    <option value="customAddOn">Custom Add-On / Other</option>
                                </select>
                            </td>
                            <td class="license-display"></td>
                            <td><input type="number" class="price-input w-28 p-1 border rounded-md" step="0.01" value="0.00"></td>
                            <td class="row-total">$0.00</td>
                            <td><button class="delete-row-btn">X</button></td>
                        </tr>
                    </tbody>
                    <tfoot>
                        <tr class="total-row">
                            <td colspan="4" class="text-right">Total Monthly Recurring Charge</td>
                            <td id="totalMonthlyRecurring">$0.00</td>
                            <td></td>
                        </tr>
                        <tr class="total-row">
                            <td colspan="4" class="text-right">Total Annual Recurring Charge</td>
                            <td id="totalAnnualRecurring">$0.00</td>
                            <td></td>
                        </tr>
                    </tfoot>
                </table>
                <button type="button" id="addMonthlyRow" class="add-row-btn bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg mb-8">Add Monthly Service</button>
            </div> <!-- End content for Page 2 -->

            <div class="page-break"></div>

            <!-- Repeated Header for ONE TIME COST page -->
            <div class="repeated-print-header">
                <div class="w-full h-12" style="background-color: #0062ff;"></div>
                <div class="header-section">
                    <img src="https://www.stackcybersecurity.com/img/logos/stack-cybersecurity-og.jpg" alt="Company Logo">
                    <div>
                        <p>33131 Schoolcraft Road</p>
                        <p>Livonia, MI 48150</p>
                        <p>734-744-5300</p>
                        <p><a href="https://stackcyber.com" class="text-blue-600 hover:underline">https://stackcyber.com</a></p>
                    </div>
                </div>
            </div>
            <!-- Content for Page 3: One Time Cost -->
            <div class="content-after-header">
                <h2 class="section-title mt-8">ONE TIME COST EQUIPMENT/LABOR/OTHER</h2>
                <table class="mb-8 rounded-lg shadow-sm" id="oneTimeCostTable">
                    <thead>
                        <tr>
                            <th>QUANTITY</th>
                            <th>DESCRIPTION</th>
                            <th>ITEM DETAIL / LICENSE</th>
                            <th>PRICE</th>
                            <th>TOTAL</th>
                            <th></th> <!-- For delete button -->
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Existing rows -->
                        <tr>
                            <td><input type="number" class="qty-input w-20 p-1 border rounded-md" value="1" min="0"></td>
                            <td>
                                <select class="one-time-service-select w-full p-1 border rounded-md">
                                    <option value="onboarding">Onboarding</option>
                                    <option value="firewall">Firewall</option>
                                    <option value="projectImplementation">Project Implementation</option>
                                    <option value="projectDiscount">Project Discount</option>
                                    <option value="onboardingDiscount">Onboarding Discount</option>
                                    <option value="tax">Tax</option>
                                    <option value="customOneTime">Custom Item</option>
                                </select>
                                <input type="text" class="custom-description-input w-full p-1 border rounded-md hidden" placeholder="Enter custom description">
                            </td>
                            <td><input type="text" class="item-detail-input w-full p-1 border rounded-md" value="Onboarding Service"></td>
                            <td><input type="number" class="price-input w-28 p-1 border rounded-md" step="0.01" value="1310.00"></td>
                            <td class="row-total">$0.00</td>
                            <td><button class="delete-row-btn">X</button></td>
                        </tr>
                        <tr>
                            <td><input type="number" class="qty-input w-20 p-1 border rounded-md" value="1" min="0"></td>
                            <td>
                                <select class="one-time-service-select w-full p-1 border rounded-md">
                                    <option value="onboarding">Onboarding</option>
                                    <option value="firewall" selected>Firewall</option>
                                    <option value="projectImplementation">Project Implementation</option>
                                    <option value="projectDiscount">Project Discount</option>
                                    <option value="onboardingDiscount">Onboarding Discount</option>
                                    <option value="tax">Tax</option>
                                    <option value="customOneTime">Custom Item</option>
                                </select>
                                <input type="text" class="custom-description-input w-full p-1 border rounded-md hidden" placeholder="Enter custom description">
                            </td>
                            <td><input type="text" class="item-detail-input w-full p-1 border rounded-md" value="Sophos XGS 128 Network Security/Firewall Appliance"></td>
                            <td><input type="number" class="price-input w-28 p-1 border rounded-md" step="0.01" value="1870.87"></td>
                            <td class="row-total">$0.00</td>
                            <td><button class="delete-row-btn">X</button></td>
                        </tr>
                        <tr>
                            <td><input type="number" class="qty-input w-20 p-1 border rounded-md" value="1" min="0"></td>
                            <td>
                                <select class="one-time-service-select w-full p-1 border rounded-md">
                                    <option value="onboarding">Onboarding</option>
                                    <option value="firewall">Firewall</option>
                                    <option value="projectImplementation" selected>Project Implementation</option>
                                    <option value="projectDiscount">Project Discount</option>
                                    <option value="onboardingDiscount">Onboarding Discount</option>
                                    <option value="tax">Tax</option>
                                    <option value="customOneTime">Custom Item</option>
                                </select>
                                <input type="text" class="custom-description-input w-full p-1 border rounded-md hidden" placeholder="Enter custom description">
                            </td>
                            <td><input type="text" class="item-detail-input w-full p-1 border rounded-md" value="Fire Wall Implementation - Flat Fee"></td>
                            <td><input type="number" class="price-input w-28 p-1 border rounded-md" step="0.01" value="1650.00"></td>
                            <td class="row-total">$0.00</td>
                            <td><button class="delete-row-btn">X</button></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>
                                <select class="one-time-service-select w-full p-1 border rounded-md">
                                    <option value="onboarding">Onboarding</option>
                                    <option value="firewall">Firewall</option>
                                    <option value="projectImplementation">Project Implementation</option>
                                    <option value="projectDiscount" selected>Project Discount</option>
                                    <option value="onboardingDiscount">Onboarding Discount</option>
                                    <option value="tax">Tax</option>
                                    <option value="customOneTime">Custom Item</option>
                                </select>
                                <input type="text" class="custom-description-input w-full p-1 border rounded-md hidden" placeholder="Enter custom description">
                            </td>
                            <td><input type="text" class="item-detail-input w-full p-1 border rounded-md" value="Fire Wall Implementation -Flat Fee Discount (enter negative value)"></td>
                            <td><input type="number" class="price-input w-28 p-1 border rounded-md" step="0.01" value="-1150.00"></td>
                            <td class="row-total">$0.00</td>
                            <td><button class="delete-row-btn">X</button></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>
                                <select class="one-time-service-select w-full p-1 border rounded-md">
                                    <option value="onboarding">Onboarding</option>
                                    <option value="firewall">Firewall</option>
                                    <option value="projectImplementation">Project Implementation</option>
                                    <option value="projectDiscount">Project Discount</option>
                                    <option value="onboardingDiscount" selected>Onboarding Discount</option>
                                    <option value="tax">Tax</option>
                                    <option value="customOneTime">Custom Item</option>
                                </select>
                                <input type="text" class="custom-description-input w-full p-1 border rounded-md hidden" placeholder="Enter custom description">
                            </td>
                            <td><input type="text" class="item-detail-input w-full p-1 border rounded-md" value="Discount with 60 Month Agreement (enter negative value)"></td>
                            <td><input type="number" class="price-input w-28 p-1 border rounded-md" step="0.01" value="-327.50"></td>
                            <td class="row-total">$0.00</td>
                            <td><button class="delete-row-btn">X</button></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>
                                <select class="one-time-service-select w-full p-1 border rounded-md">
                                    <option value="onboarding">Onboarding</option>
                                    <option value="firewall">Firewall</option>
                                    <option value="projectImplementation">Project Implementation</option>
                                    <option value="projectDiscount">Project Discount</option>
                                    <option value="onboardingDiscount">Onboarding Discount</option>
                                    <option value="tax" selected>Tax</option>
                                    <option value="customOneTime">Custom Item</option>
                                </select>
                                <input type="text" class="custom-description-input w-full p-1 border rounded-md hidden" placeholder="Enter custom description">
                            </td>
                            <td><input type="text" class="item-detail-input w-full p-1 border rounded-md" value=""></td>
                            <td><input type="number" class="price-input w-28 p-1 border rounded-md" step="0.01" value="211.25"></td>
                            <td class="row-total">$0.00</td>
                            <td><button class="delete-row-btn">X</button></td>
                        </tr>
                    </tbody>
                    <tfoot>
                        <tr class="total-row">
                            <td colspan="4" class="text-right">Total One Time Charge</td>
                            <td id="totalOneTimeCharge">$0.00</td>
                            <td></td>
                        </tr>
                    </tfoot>
                </table>
                <button type="button" id="addOneTimeRow" class="add-row-btn bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg mb-8">Add One-Time Item</button>

                <!-- Grand Total Section -->
                <div class="grand-total-section">
                    <div>
                        <span>Total Monthly Recurring (x Agreement Months)</span>
                        <span id="grandTotalMonthlyRecurring">$0.00</span>
                    </div>
                    <div>
                        <span>Total One Time Charge</span>
                        <span id="grandTotalOneTimeCharge">$0.00</span>
                    </div>
                    <div>
                        <span>GRAND TOTAL</span>
                        <span id="grandTotal">$0.00</span>
                    </div>
                </div>

            </div> <!-- End content for Page 3 -->

            <div class="page-break"></div>

            <!-- Repeated Header for HOURLY OPTIONS page -->
            <!-- This header is removed as per user request to delete the last header on the last page -->
            <!-- <div class="repeated-print-header">
                <div class="w-full h-12" style="background-color: #0062ff;"></div>
                <div class="header-section">
                    <img src="https://www.stackcybersecurity.com/img/logos/stack-cybersecurity-og.jpg" alt="Company Logo">
                    <div>
                        <p>33131 Schoolcraft Road</p>
                        <p>Livonia, MI 48150</p>
                        <p>734-744-5300</p>
                        <p><a href="https://stackcyber.com" class="text-blue-600 hover:underline">https://stackcyber.com</a></p>
                    </div>
                </div>
            </div> -->
            <!-- Content for Page 4: Hourly Options & Acceptance -->
            <div class="content-after-header">
                <h2 class="section-title">HOURLY OPTIONS</h2>
                <ul class="list-disc list-inside text-gray-700 leading-relaxed mb-6 ml-4">
                    <li>Hourly Rate for out of contract services: $200.00</li>
                    <li>10 Block Hours @$180 for project & out of contract services: $1,800.00</li>
                    <li>20 Block Hours @$165 for project & out of contract services: $3,300.00</li>
                    <li>50 Block Hours @$150 for project & out of contract services: $7,500.00</li>
                </ul>
                <p class="text-gray-600 text-sm italic ml-4">(Block Hours expire in 12 months)</p>
                <div class="acceptance-section">
                    <p class="text-center">
                        I hereby accept the terms of this quotation and would like to proceed with the above-mentioned service
                        offerings of AM Data Service, Inc.
                    </p>
                    <div class="signature-line"></div>
                        <p class="text-sm text-gray-600 mt-2"> (Signature & Date)</p>
                    <div class="signature-line"></div>
                        <p class="text-sm text-gray-600 mt-2"> (Print Name)</p>
                </div>
            </div> <!-- End content for Page 4 -->

        <div class="button-group">
            <button onclick="calculateAndDisplay()">Calculate & Update Quote</button>
            <button onclick="window.print()">Print/Save as PDF</button>
        </div>
    </div>

    <!-- Print Footer Template (hidden in screen view) -->
    <div class="print-footer" style="display: none;">
        STACK Cybersecurity | Page <span class="page-number"></span>
    </div>

    <script>
        // Define monthly plans and their properties
        const monthlyPlans = {
            "securityBasics": { name: "Security Basics", unitPrice: 85.00, license: "Per User | Per Month" },
            "securityStandardsPlan": { name: "Security Standards (Plan)", unitPrice: 200.00, license: "Per User | Per Month" },
            "coreStack": { name: "CoreSTACK", unitPrice: 300.00, license: "Per User | Per Month" },
            "cyberStack": { name: "CyberSTACK", unitPrice: 365.00, license: "Per User | Per Month" },
            "securityStandardsServer": { name: "Security Standards (Per Server)", unitPrice: 85.00, license: "Per Server | Per Month" },
            "cioCiso": { name: "CIO/CISO - As Needed", unitPrice: 20.00, license: "Flat Rate | Per Month" },
            "annualPenTesting": { name: "Annual Automated Penetration Testing", unitPrice: 40.00, license: "Flat Rate | Per Month" },
            "hardwareFirewall": { name: "Hardware Firewall", unitPrice: 120.00, license: "Flat Rate | Per Month" },
            "customAddOn": { name: "Custom Add-On / Other", unitPrice: 0.00, license: "Custom | Per Month" }
        };

        const oneTimeItems = {
            "onboarding": { description: "Onboarding", itemDetail: "Onboarding project Cloud Infrastructure Security: Locking down and securing the cloud and server infrastructure to enhance protection for web applications accessed by clients. In-office network remediation, including wireless and perimeter security. Security Basics install - 13 Devices", price: 1310.00 },
            "firewall": { description: "Firewall", itemDetail: "Sophos XGS 128 Network Security/Firewall Appliance", price: 1870.87 },
            "projectImplementation": { description: "Project Implementation", itemDetail: "Fire Wall Implementation - Flat Fee", price: 1650.00 },
            "projectDiscount": { description: "Project Discount", itemDetail: "Fire Wall Implementation -Flat Fee Discount (enter negative value)", price: -1150.00 },
            "onboardingDiscount": { description: "Onboarding Discount", itemDetail: "Discount with 60 Month Agreement (enter negative value)", price: -327.50 },
            "tax": { description: "Tax", itemDetail: "", price: 211.25 },
            "customOneTime": { description: "Custom Item", itemDetail: "Enter custom item detail", price: 0.00 } // Updated default itemDetail
        };

        // Function to format numbers as currency
        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD',
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            }).format(amount);
        }

        // Function to create a new monthly recurring row
        function createMonthlyRow() {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td><input type="number" class="qty-input w-20 p-1 border rounded-md" value="1" min="0"></td>
                <td>
                    <select class="service-select w-full p-1 border rounded-md">
                        ${Object.keys(monthlyPlans).map(key => `<option value="${key}">${monthlyPlans[key].name}</option>`).join('')}
                    </select>
                </td>
                <td class="license-display"></td>
                <td><input type="number" class="price-input w-28 p-1 border rounded-md" step="0.01" value="0.00"></td>
                <td class="row-total">$0.00</td>
                <td><button class="delete-row-btn">X</button></td>
            `;
            // Add event listeners to the new elements
            row.querySelector('.qty-input').addEventListener('input', calculateAndDisplay);
            row.querySelector('.service-select').addEventListener('change', (event) => {
                handleMonthlyServiceChange(event.target);
                calculateAndDisplay();
            });
            row.querySelector('.price-input').addEventListener('input', calculateAndDisplay);
            row.querySelector('.delete-row-btn').addEventListener('click', deleteRow);

            // Initial setup for the new row
            handleMonthlyServiceChange(row.querySelector('.service-select'));
            return row;
        }

        // Function to create a new one-time cost row
        function createOneTimeRow() {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td><input type="number" class="qty-input w-20 p-1 border rounded-md" value="1" min="0"></td>
                <td>
                    <select class="one-time-service-select w-full p-1 border rounded-md">
                        ${Object.keys(oneTimeItems).map(key => `<option value="${key}">${oneTimeItems[key].description}</option>`).join('')}
                    </select>
                    <input type="text" class="custom-description-input w-full p-1 border rounded-md hidden" placeholder="Enter custom description">
                </td>
                <td><input type="text" class="item-detail-input w-full p-1 border rounded-md" value=""></td>
                <td><input type="number" class="price-input w-28 p-1 border rounded-md" step="0.01" value="0.00"></td>
                <td class="row-total">$0.00</td>
                <td><button class="delete-row-btn">X</button></td>
            `;
            // Add event listeners to the new elements
            row.querySelector('.qty-input').addEventListener('input', calculateAndDisplay);
            row.querySelector('.one-time-service-select').addEventListener('change', (event) => {
                handleOneTimeServiceChange(event.target);
                calculateAndDisplay();
            });
            row.querySelector('.custom-description-input').addEventListener('input', calculateAndDisplay);
            row.querySelector('.item-detail-input').addEventListener('input', calculateAndDisplay); // Renamed from license-input
            row.querySelector('.price-input').addEventListener('input', calculateAndDisplay);
            row.querySelector('.delete-row-btn').addEventListener('click', deleteRow);

            // Initial setup for the new row
            handleOneTimeServiceChange(row.querySelector('.one-time-service-select'));
            return row;
        }

        // Function to delete a row
        function deleteRow(event) {
            const row = event.target.closest('tr');
            row.remove();
            calculateAndDisplay(); // Recalculate totals after deletion
        }

        // Handle change event for monthly service select
        function handleMonthlyServiceChange(selectElement) {
            const row = selectElement.closest('tr');
            const selectedPlanKey = selectElement.value;
            const selectedPlan = monthlyPlans[selectedPlanKey];
            const licenseDisplay = row.querySelector('.license-display');
            const priceInput = row.querySelector('.price-input');

            if (licenseDisplay) {
                licenseDisplay.textContent = selectedPlan.license;
            }

            if (selectedPlanKey !== "customAddOn") {
                priceInput.value = selectedPlan.unitPrice.toFixed(2);
                priceInput.readOnly = true; // Make price read-only for predefined items
                priceInput.classList.add('bg-gray-100'); // Add a visual cue for read-only
            } else {
                priceInput.value = "0.00"; // Reset to 0 for custom
                priceInput.readOnly = false; // Make price editable for custom
                priceInput.classList.remove('bg-gray-100'); // Remove visual cue
            }
        }

        // Handle change event for one-time service select
        function handleOneTimeServiceChange(selectElement) {
            const row = selectElement.closest('tr');
            const selectedItemKey = selectElement.value;
            const selectedItem = oneTimeItems[selectedItemKey];
            const customDescriptionInput = row.querySelector('.custom-description-input');
            const itemDetailInput = row.querySelector('.item-detail-input'); // Renamed from license-input
            const priceInput = row.querySelector('.price-input');

            // Always show the select element initially
            selectElement.classList.remove('hidden');

            if (selectedItemKey === "customOneTime") {
                customDescriptionInput.classList.remove('hidden'); // Show custom description input
                selectElement.classList.add('hidden'); // Hide the select element for custom item
                // If the custom description input is empty, set its value to the default custom item description
                if (customDescriptionInput.value === "") {
                    customDescriptionInput.value = selectedItem.description;
                }
                itemDetailInput.value = selectedItem.itemDetail; // Set default item detail for custom
                itemDetailInput.readOnly = false; // Make item detail editable for custom
                itemDetailInput.classList.remove('bg-gray-100');
                priceInput.value = selectedItem.price.toFixed(2);
                priceInput.readOnly = false; // Make price editable for custom
                priceInput.classList.remove('bg-gray-100');
            } else {
                customDescriptionInput.classList.add('hidden'); // Hide custom description input
                selectElement.classList.remove('hidden'); // Show the select element
                // Set the item detail and price based on the selected predefined item
                itemDetailInput.value = selectedItem.itemDetail;
                itemDetailInput.readOnly = true;
                itemDetailInput.classList.add('bg-gray-100');
                priceInput.value = selectedItem.price.toFixed(2);
                priceInput.readOnly = true;
                priceInput.classList.add('bg-gray-100');
            }
        }

        // Function to calculate and display costs
        function calculateAndDisplay() {
            // Get input values
            const agreementMonths = parseInt(document.getElementById('agreementMonths').value) || 0;

            let totalMonthlyRecurring = 0;

            // Loop through each monthly recurring service row
            document.querySelectorAll('#monthlyRecurringTable tbody tr').forEach(row => {
                const qtyInput = row.querySelector('.qty-input');
                const serviceSelect = row.querySelector('.service-select');
                const priceInput = row.querySelector('.price-input');
                const rowTotalDisplay = row.querySelector('.row-total');

                const quantity = parseInt(qtyInput.value) || 0;
                const selectedPlanKey = serviceSelect.value;
                const selectedPlan = monthlyPlans[selectedPlanKey];

                let unitPrice = parseFloat(priceInput.value) || 0; // Use current input value if user typed

                // If it's not a custom add-on, ensure the price input reflects the default unit price
                if (selectedPlanKey !== "customAddOn") {
                    unitPrice = selectedPlan.unitPrice;
                    priceInput.value = unitPrice.toFixed(2); // Update input field with default price
                }
                // For customAddOn, unitPrice is already taken from the input field.

                const rowTotal = quantity * unitPrice;
                rowTotalDisplay.textContent = formatCurrency(rowTotal);
                totalMonthlyRecurring += rowTotal;
            });

            document.getElementById('totalMonthlyRecurring').textContent = formatCurrency(totalMonthlyRecurring);
            document.getElementById('totalAnnualRecurring').textContent = formatCurrency(totalMonthlyRecurring * 12);


            // One-Time Costs
            let totalOneTimeCharge = 0;
            document.querySelectorAll('#oneTimeCostTable tbody tr').forEach(row => {
                const qtyInput = row.querySelector('.qty-input');
                const serviceSelect = row.querySelector('.one-time-service-select');
                const customDescriptionInput = row.querySelector('.custom-description-input');
                const itemDetailInput = row.querySelector('.item-detail-input'); // Renamed from license-input
                const priceInput = row.querySelector('.price-input');
                const rowTotalDisplay = row.querySelector('.row-total');

                // Quantity can be empty for discount/tax rows, default to 1 if input is not found (e.g., for custom items without a qty field)
                const quantity = (qtyInput ? parseInt(qtyInput.value) : 1) || 0;
                const selectedItemKey = serviceSelect.value;
                const selectedItem = oneTimeItems[selectedItemKey];

                // Handle custom description input visibility and value
                if (selectedItemKey === "customOneTime") {
                    customDescriptionInput.classList.remove('hidden'); // Show custom input
                    serviceSelect.classList.add('hidden'); // Hide the select element for custom item
                    if (customDescriptionInput.value === "") { // Only set default if empty
                        customDescriptionInput.value = selectedItem.description;
                    }
                    itemDetailInput.readOnly = false;
                    priceInput.readOnly = false;
                    itemDetailInput.classList.remove('bg-gray-100');
                    priceInput.classList.remove('bg-gray-100');
                } else {
                    customDescriptionInput.classList.add('hidden'); // Hide custom input
                    serviceSelect.classList.remove('hidden'); // Show the select element
                    itemDetailInput.value = selectedItem.itemDetail;
                    priceInput.value = selectedItem.price.toFixed(2);
                    itemDetailInput.readOnly = true;
                    priceInput.classList.add('bg-gray-100');
                    itemDetailInput.readOnly = true;
                    itemDetailInput.classList.add('bg-gray-100');
                }

                const unitPrice = parseFloat(priceInput.value) || 0;
                const rowTotal = quantity * unitPrice;
                rowTotalDisplay.textContent = formatCurrency(rowTotal);
                totalOneTimeCharge += rowTotal;
            });

            document.getElementById('totalOneTimeCharge').textContent = formatCurrency(totalOneTimeCharge);

            // Calculate and display Grand Totals
            const grandTotalMonthlyRecurring = totalMonthlyRecurring * agreementMonths;
            document.getElementById('grandTotalMonthlyRecurring').textContent = formatCurrency(grandTotalMonthlyRecurring);
            document.getElementById('grandTotalOneTimeCharge').textContent = formatCurrency(totalOneTimeCharge);
            document.getElementById('grandTotal').textContent = formatCurrency(grandTotalMonthlyRecurring + totalOneTimeCharge);
        }

        // Add event listeners when the DOM is fully loaded
        document.addEventListener('DOMContentLoaded', () => {
            // Set today's date as default for proposalDate if it's empty
            const proposalDateInput = document.getElementById('proposalDate');
            if (!proposalDateInput.value) {
                const today = new Date();
                const yyyy = today.getFullYear();
                const mm = String(today.getMonth() + 1).padStart(2, '0'); // Months are 0-indexed
                const dd = String(today.getDate()).padStart(2, '0');
                proposalDateInput.value = `${yyyy}-${mm}-${dd}`;
            }

            // Initial setup for existing monthly recurring rows
            document.querySelectorAll('#monthlyRecurringTable tbody tr').forEach(row => {
                const serviceSelect = row.querySelector('.service-select');
                if (serviceSelect) {
                    handleMonthlyServiceChange(serviceSelect);
                    serviceSelect.addEventListener('change', (event) => {
                        handleMonthlyServiceChange(event.target);
                        calculateAndDisplay();
                    });
                }
                row.querySelector('.qty-input').addEventListener('input', calculateAndDisplay);
                row.querySelector('.price-input').addEventListener('input', calculateAndDisplay);
                row.querySelector('.delete-row-btn').addEventListener('click', deleteRow);
            });

            // Initial setup for existing one-time cost rows
            document.querySelectorAll('#oneTimeCostTable tbody tr').forEach(row => {
                const serviceSelect = row.querySelector('.one-time-service-select');
                if (serviceSelect) {
                    handleOneTimeServiceChange(serviceSelect);
                    serviceSelect.addEventListener('change', (event) => {
                        handleOneTimeServiceChange(event.target);
                        calculateAndDisplay();
                    });
                }
                const qtyInput = row.querySelector('.qty-input');
                if (qtyInput) qtyInput.addEventListener('input', calculateAndDisplay);
                row.querySelector('.custom-description-input').addEventListener('input', calculateAndDisplay);
                row.querySelector('.item-detail-input').addEventListener('input', calculateAndDisplay); // Renamed from license-input
                row.querySelector('.price-input').addEventListener('input', calculateAndDisplay);
                row.querySelector('.delete-row-btn').addEventListener('click', deleteRow);
            });

            // Add new row buttons
            document.getElementById('addMonthlyRow').addEventListener('click', () => {
                const tbody = document.querySelector('#monthlyRecurringTable tbody');
                tbody.appendChild(createMonthlyRow());
                calculateAndDisplay();
            });

            document.getElementById('addOneTimeRow').addEventListener('click', () => {
                const tbody = document.querySelector('#oneTimeCostTable tbody');
                tbody.appendChild(createOneTimeRow());
                calculateAndDisplay();
            });

            // Add event listeners to general input fields
            const generalInputs = document.querySelectorAll(
                '#agreementMonths, #clientName, #proposalDate, #needsAssessmentText'
            );
            generalInputs.forEach(input => {
                input.addEventListener('input', calculateAndDisplay);
                input.addEventListener('change', calculateAndDisplay);
            });

            // Initial calculation on page load
            calculateAndDisplay();
        });

        // Function to handle page numbers for print
        window.onbeforeprint = () => {
            const totalPages = Math.ceil(document.body.scrollHeight / window.innerHeight); // Estimate total pages
            const printFooter = document.querySelector('.print-footer');
            if (printFooter) {
                printFooter.style.display = 'block'; // Show footer for printing
                // This is a basic page numbering. For more accurate, complex layouts,
                // a dedicated PDF generation library or more advanced CSS print rules might be needed.
                // For simplicity, we'll just show the total pages on each footer.
                // A more advanced solution would involve iterating through each page.
                // For now, we'll just set a placeholder for the page number.
                // Browsers often handle page numbering automatically in print previews.
                // This is just to ensure the footer is visible.
                printFooter.querySelector('.page-number').textContent = 'of ' + totalPages;
            }
        };

        window.onafterprint = () => {
            const printFooter = document.querySelector('.print-footer');
            if (printFooter) {
                printFooter.style.display = 'none'; // Hide footer after printing
            }
        };
    </script>
</body>
</html>
